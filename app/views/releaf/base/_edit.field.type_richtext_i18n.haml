- default_locale = Settings.i18n_locales.first

.field.type_richtext.i18n{ :'data-name' => name }
  - Settings.i18n_locales.each_with_index do |locale, i|
    - translation = f.object.translations.find_or_initialize_by_locale(locale)
    - is_default_locale = locale == default_locale

    .localization{:"data-locale" => locale, :style => is_default_locale ? nil : 'display:none'}
      = f.fields_for :"translations", translation, :child_index => i do |ff|
        .label_wrap
          = ff.label name, name.sub(/_html$/, '').humanize + ':'
        .value
          - unless translation.new_record?
            = ff.hidden_field :id
          = ff.hidden_field :locale

          - if is_default_locale
            = f.hidden_field name, :class => :sync_field
            = ff.text_area name, :rows => 5, :cols => 75, :class => "richtext sync_field"
          - else
            = ff.text_area name, :rows => 5, :cols => 75, :class => "richtext"
        .clear

  .localization_buttons
    - Settings.i18n_locales.each_with_index do |locale, i|
      - is_default_locale = locale == default_locale
      %button{:type => :button, :"data-locale" => locale, :class => is_default_locale ? :active : nil}= locale
